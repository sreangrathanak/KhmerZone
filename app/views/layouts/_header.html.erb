<nav class="navbar navbar-default navbar-fixed-top" data-spy="affix">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#user-bar"> 
        <i class="glyphicon glyphicon-user"></i>
      </button>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#my-header-form">        
        <span class="glyphicon glyphicon-home"></span>        
      </button>
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#search-bar">        
        <i class="glyphicon glyphicon-search"></i>      
      </button>      

      <button type="button" class="pull-left navbar-toggle collapsed" data-toggle="collapse" data-target="#side-menu">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a class="navbar-brand" href="#">E-Store</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse pull-left" id="my-header-form">      
      <ul class="nav navbar-nav">
        <%if user_signed_in?%>
          <li>
            <%= link_to raw('<div class="glyphicon glyphicon-home 
            my-btn"><b>Home</b></div>'),root_path%>
          </li>
          <li>
          <%= render "layouts/user_notifications"%>
          </li>
          <li><%= render "layouts/user_message_notice_header"%></li>
          <li>
            <%= link_to raw('<div class="glyphicon glyphicon-shopping-cart 
            my-btn"><b>Stores</b></div>'),stores_path%>
          </li>        
        <%else%>
          <li><%= link_to raw('<div class="glyphicon glyphicon-home 
            my-btn"><b>Home</b></div>'),root_path%>
          </li>
          <li>
            <%= link_to raw('<div class="glyphicon glyphicon-shopping-cart 
             my-btn"><b>Stores</b></div>'),stores_path%>
          </li>
        <%end%>
      </ul>
    </div><!-- /.navbar-collapse --> 

    <div class="collapse navbar-collapse pull-left" id="search-bar">
      <ul class="nav navbar-nav">
      <%= form_tag simple_search_path,class: 'navbar-form', role: 'search', :method => :get do %>       
        <div class="input-group">
          <%= text_field_tag :search_key, params[:search_key],
          {class:"form-control", 
            placeholder:"Search"} %>          
            <div class="input-group-btn">              
              <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>              
            </div>            
        </div>
        <%= link_to "Advance",new_search_path%>
      <%end %>      
      </ul>
    </div>
    <div class="collapse navbar-collapse" id="user-bar">
      <ul class="nav navbar-nav navbar-right">
        <%if user_signed_in?%>          
          <li class="dropdown">          
            <%= link_to user_image_profile(current_user,size:"small",
            border:"circle"),"#",class:"dropdown-toggle",id:"user-header", 
            'aria-expanded' =>'false',:data => {:toggle=>"dropdown"} %>
            <ul class="dropdown-menu" role="menu">
              <li><%= link_to user_path(current_user) do%>
                <span class="glyphicon glyphicon-user"> </span> <%=current_user.name%>
              <%end%>
              </li>
              <li>
              <%= link_to edit_user_path(current_user),remote:true do%>
                <span class="glyphicon glyphicon-wrench"> </span> Sitting
              <%end%>
              </li>            
              <li class="divider"></li>
              <li><%= link_to signout_path do%>
                <span class="glyphicon glyphicon-log-out"></span> Sign Out                  
              <%end%>
              </li>
            </ul>
          </li>
          <li>
            <%=link_to "PostPro",new_user_product_path(current_user),
              remote:true,class: "btn btn-success",id:"btn-user-header"%>
          </li>
        <%else%>
          <li>
            <%= link_to signin_path,class:"" do%>              
              <span class="glyphicon glyphicon-log-in"></span> Login
            <%end%>
          </li>
          <li>
            <%= link_to signup_path,class:"" do%>
              <span class="glyphicon glyphicon-user"></span> Sign Up
            <%end%>
          </li>        
        <%end%>
      </ul>
    </div>       
  </div><!-- /.container-fluid -->

  <!-- Sidebar Menu Items - These collapse to the responsive navigation menu on small screens -->
      <div class="collapse navbar-collapse" id="side-menu">
        <ul class="navbar-default nav navbar-nav side-nav" id="scroll-style">
          <li class="active">
            <a href="#"> All</a>
          </li>          
          <li>          
            <%MainCategory.all.each do |main_category|%>
              <a href="javascript:;" data-toggle="collapse" 
                data-target="#demo-<%=main_category.id%>">
                <%= main_category.name%> 
              </a>
              <ul id="demo-<%=main_category.id%>" class="collapse">
                <%main_category.categories.each do |category|%>
                  <li>
                    <a href="#"><%= category.name%></a>
                  </li>
                <%end%>            
              </ul>
            <%end%>
          </li>          
          </ul>
        </div>
      <!-- /.navbar-collapse -->
</nav>
<div id="top-shadow"></div>
<script type="text/javascript">
  $(document).ready(function(){
    $(window).scroll(function(){
      var y = $(window).scrollTop();
      if( y > 0 ){
        $("#top-shadow").css({'display':'block', 'opacity':y/20});
        } else {
          $("#top-shadow").css({'display':'block', 'opacity':y/20});
        }
      });
    });
</script>